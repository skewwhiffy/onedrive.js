(function(e){function t(t){for(var n,i,u=t[0],o=t[1],c=t[2],f=0,h=[];f<u.length;f++)i=u[f],a[i]&&h.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);l&&l(t);while(h.length)h.shift()();return s.push.apply(s,c||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,u=1;u<r.length;u++){var o=r[u];0!==a[o]&&(n=!1)}n&&(s.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},a={app:0},s=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],o=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var l=o;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"3c5e":function(e,t,r){"use strict";var n=r("85f6"),a=r.n(n);a.a},"47a9":function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return s});r("f559"),r("aef6"),r("28a5");var n=r("d225"),a=r("b0b4"),s=function(){function t(){Object(n["a"])(this,t)}return Object(a["a"])(t,[{key:"tab",get:function(){return e.window.location.pathname.split("/").filter(function(e){return e})[0]},set:function(t){var r="/".concat(t);e.history.pushState({id:t},t,r)}},{key:"folderPath",get:function(){return e.window.location.pathname.split("/").filter(function(e){return e}).slice(1).join("/")},set:function(t){var r=t;void 0===r&&(r=""),r.endsWith("/")&&(r=r.substring(0,r.length-1)),r.startsWith("/")&&(r=r.substring(1));var n="/file/".concat(r);e.history.pushState({id:r},r,n)}}]),t}()}).call(this,r("c8ba"))},"56d7":function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var n=r("2b0e"),a=r("5f5b"),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("TopBar"),r("Main")],1)},i=[],u=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},o=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",[e._v("onedrive.js - a client for OneDrive")])])}],c=n["default"].extend({name:"TopBar"}),l=c,f=r("2877"),h=Object(f["a"])(l,u,o,!1,null,"8474968c",null),d=h.exports,p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-tabs",{on:{input:e.tabChange},model:{value:e.activeTabIndex,callback:function(t){e.activeTabIndex=t},expression:"activeTabIndex"}},[r("b-tab",{attrs:{title:"Users"}},[r("User",{on:{setUserStatus:e.setUserStatus,setUserId:e.setUserId}})],1),r("b-tab",{attrs:{title:"Files"}},[e.userId?r("File",{attrs:{"user-id":e.userId,"user-status":e.userStatus}}):e._e()],1)],1)],1)},v=[],b=(r("6762"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",[e._v("Users")]),e.loading?e._e():r("div",[r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-2"},[0===e.users.length?r("h2",[e._v("\n          No users\n        ")]):e._e(),r("ul",e._l(e.users,function(t){return r("li",{key:t.id},[e._v("\n            "+e._s(t.displayName)+"\n          ")])}),0),1!==e.users.length?r("b-button",{on:{click:e.addUser}},[e._v("\n          Add\n        ")]):e._e()],1),r("div",{staticClass:"col-sm-10"},[r("p",[e._v("Status "+e._s(e.status))])])])]),e.loading?r("div",[r("h2",[e._v("Loading")])]):e._e()])}),m=[],g=(r("96cf"),r("3b8d")),x=(r("ac6a"),r("456d"),r("aef6"),r("f559"),r("d225")),w=r("b0b4"),y=r("bc3a"),k=r.n(y),_=k.a.create({baseURL:"http://localhost:38080"}),j=_,O=function(){function e(t){Object(x["a"])(this,e),this.axios=t||j}return Object(w["a"])(e,[{key:"getHealth",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.axios.get("/api/health");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getSubfolders",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(void 0!==r){e.next=2;break}return e.abrupt("return",this.getSubfolders(t,""));case 2:if(!r.startsWith("/")){e.next=4;break}return e.abrupt("return",this.getSubfolders(t,r.substring(1)));case 4:if(!r.endsWith("/")){e.next=6;break}return e.abrupt("return",this.getSubfolders(t,r.substring(0,r.length-1)));case 6:return e.next=8,this.axios.get("/api/user/".concat(t,"/folder/").concat(r));case 8:return n=e.sent,e.abrupt("return",n.data);case 10:case"end":return e.stop()}},e,this)}));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getStatus",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.axios.get("/api/user/".concat(t,"/status"));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getUsers",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.axios.get("/api/user");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getLoginUrl",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t,r,n,a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.axios.put("/api/user");case 2:return t=e.sent,r=t.data,n=r.query,a=r.redirect,s=Object.keys(n).map(function(e){return{key:e,value:n[e]}}).map(function(e){var t=e.key,r=e.value;return{key:encodeURIComponent(t),value:encodeURIComponent(r)}}).map(function(e){var t=e.key,r=e.value;return"".concat(t,"=").concat(r)}).join("&"),e.abrupt("return","".concat(a,"?").concat(s));case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}]),e}(),I=new O,U=n["default"].extend({name:"Main",data:function(){return{loading:!1,users:[],status:"unknown",loginUrl:!1}},created:function(){this.refreshUserList()},methods:{refreshUserList:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,I.getUsers();case 3:if(this.users=e.sent,1!==this.users.length){e.next=11;break}return this.$emit("setUserId",this.users[0].id),e.next=8,I.getStatus(this.users[0].id);case 8:t=e.sent,this.status=t.status,this.$emit("setUserStatus",this.status);case 11:return e.next=13,I.getLoginUrl();case 13:this.loginUrl=e.sent,this.loading=!1;case 15:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),addUser:function(){window.location.href=this.loginUrl}}}),R=U,S=Object(f["a"])(R,b,m,!1,null,null,null),T=S.exports,C=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",[e._v("Files")]),r("div",[r("b-breadcrumb",{attrs:{items:e.breadcrumbs}})],1),r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-2"},[r("ul",{staticClass:"folder-list"},[0===e.folders.length?r("li",[e._v("\n          No folders\n        ")]):e._e(),e._l(e.folders,function(t){return r("li",{key:t.id,staticClass:"text-truncate"},[r("a",{attrs:{href:e.toFolder(t.name)}},[r("font-awesome-icon",{attrs:{icon:"folder-open"}}),e._v("\n              "+e._s(t.name)+"\n          ")],1)])})],2)]),r("div",{staticClass:"col-sm-10"},[r("ul",{staticClass:"file-list"},e._l(e.files,function(t){return r("li",{key:t.id},[r("font-awesome-icon",{attrs:{icon:"file"}}),e._v("\n            "+e._s(t.name)+"\n        ")],1)}),0)])])])},P=[],F=(r("7f7f"),r("75fc")),$=(r("28a5"),r("c5f6"),r("1315")),M=r("2ef0"),B=r.n(M),E=r("ad3d"),L=r("df7c"),A=r.n(L),N=r("47a9"),W=new O,q=new N["a"],D=n["default"].extend({name:"File",components:{FontAwesomeIcon:E["a"]},props:{userId:{type:[Number,Boolean],default:!1},userStatus:{type:String,required:!0}},data:function(){return{folders:[],files:[],path:"",refreshInterval:0,nextPoll:!1}},computed:{breadcrumbs:function(){var e=this.path.split("/").filter(function(e){return e}),t=[];return e.length>0&&t.push({text:"root",href:"/file"}),t.push.apply(t,Object(F["a"])(e.map(function(t,r){return{text:decodeURI(t),href:"/file/".concat(e.slice(0,r+1).join("/"))}}))),t}},watch:{userId:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.refresh();case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),userStatus:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:e.t0=this.userStatus,e.next="onedriveSync"===e.t0?3:"localSync"===e.t0?5:7;break;case 3:return this.refreshInterval=5,e.abrupt("break",8);case 5:return this.refreshInterval=30,e.abrupt("break",8);case 7:this.refreshInterval=0;case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},created:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.refresh(),this.poll();case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),destroyed:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.refreshInterval=-1;case 1:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{refresh:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.userId){e.next=2;break}return e.abrupt("return");case 2:return this.path=q.folderPath,e.next=5,W.getSubfolders(this.userId,this.path);case 5:t=e.sent,r=t.folders,n=t.files,this.folders=B.a.sortBy(r,function(e){return e.name}),this.files=B.a.sortBy(n,function(e){return e.name});case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),toFolder:function(e){return A.a.join("/file",this.path,e)},poll:function(){var e=Object(g["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=$["DateTime"].local(),!(this.refreshInterval<0)){e.next=3;break}return e.abrupt("return");case 3:if(!this.refreshInterval||this.nextPoll&&!(this.nextPoll<t)){e.next=7;break}return e.next=6,this.refresh();case 6:this.nextPoll=t.plus({seconds:this.refreshInterval});case 7:setTimeout(this.poll,1e3);case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}}),J=D,H=(r("3c5e"),Object(f["a"])(J,C,P,!1,null,"7e5d7578",null)),z=H.exports,G=new N["a"],K=["user","file"],Q=n["default"].extend({name:"Main",components:{User:T,File:z},data:function(){return{activeTabIndex:0,userId:!1,userStatus:"unknown"}},created:function(){this.refreshActiveTabFromUrl()},methods:{tabChange:function(e){var t=K[e];G.tab=t},refreshActiveTabFromUrl:function(){K.includes(G.tab)&&(this.activeTabIndex=K.indexOf(G.tab))},setUserId:function(e){this.userId=e},setUserStatus:function(e){this.userStatus=e}}}),V=Q,X=Object(f["a"])(V,p,v,!1,null,null,null),Y=X.exports,Z=n["default"].extend({name:"App",components:{TopBar:d,Main:Y}}),ee=Z,te=Object(f["a"])(ee,s,i,!1,null,null,null),re=te.exports,ne=r("ecee"),ae=r("c074");r("f9e3"),r("2dd8");ne["c"].add(ae["a"],ae["b"]),n["default"].component("font-awesome-icon",E["a"]),n["default"].config.productionTip=!1,n["default"].use(a["a"]),new n["default"]({render:function(e){return e(re)}}).$mount("#app")},"85f6":function(e,t,r){}});
//# sourceMappingURL=app.f625c0c7.js.map